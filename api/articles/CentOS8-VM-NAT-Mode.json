{"title":"How to connect CentOS8 VM to internet via NAT mode","uid":"0723a0f3da0efde08b22864279957623","slug":"CentOS8-VM-NAT-Mode","date":"2021-08-14T16:00:00.000Z","updated":"2022-01-21T18:29:22.357Z","comments":true,"path":"api/articles/CentOS8-VM-NAT-Mode.json","keywords":"webDesign","cover":[],"content":"<div class=\"custom-quote tip\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06\"></path>\n<path stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M11.99 18H12.01\"></path>\n</svg></span>\n<p class=\"custom-quote-title\">基本原理</p>\n<p>通过<code>VMnet8</code>网卡实现主机与虚拟机之间的通信，在<code>NAT模式</code>中，主机网卡直接与虚拟NAT设备相连，然后虚拟NAT设备与虚拟DHCP服务器一起连接在虚拟交换机<code>VMnet8</code>上，这样就实现了虚拟机联网</p>\n</div>\n<hr>\n<h3 id=\"启用VMware网址转换服务\"><a href=\"#启用VMware网址转换服务\" class=\"headerlink\" title=\"启用VMware网址转换服务\"></a>启用<code>VMware</code>网址转换服务</h3><ul>\n<li>win10<code>WIN+R</code>打开搜索框，输入<code>services.msc</code>打开服务</li>\n<li>开启<code>VMware DHCP service</code>&amp;<code>VMware NAT service</code>两项服务</li>\n</ul>\n<h3 id=\"启用ICMPv4-in入站规则\"><a href=\"#启用ICMPv4-in入站规则\" class=\"headerlink\" title=\"启用ICMPv4-in入站规则\"></a>启用<code>ICMPv4-in</code>入站规则</h3><ul>\n<li>win10<code>WIN+I</code>打开设置，搜索防火墙并进入，选择<code>高级设置</code></li>\n<li>开启3个<code>ICMPv4-In</code>入站规则</li>\n</ul>\n<h3 id=\"配置虚拟机NAT模式\"><a href=\"#配置虚拟机NAT模式\" class=\"headerlink\" title=\"配置虚拟机NAT模式\"></a>配置虚拟机<code>NAT模式</code></h3><ul>\n<li><p>设置虚拟机网络连接模式</p>\n<ul>\n<li>选中虚拟机，<code>编辑虚拟机设置</code> &gt; <code>硬件 | 网络适配器</code> &gt; <code>网络连接 | NAT模式</code></li>\n</ul>\n</li>\n<li><p>配置虚拟机网关</p>\n<ul>\n<li><code>VMware</code>菜单栏 &gt; <code>编辑</code> &gt; <code>虚拟网络编辑器</code> &gt; 选中<code>VMnet8 NAT模式</code></li>\n<li>打开<code>NAT设置</code>，查看子网<code>网关IP: 192.168.56.2</code>，保留默认配置</li>\n<li>打开<code>DNS设置</code>，设置<code>首选DNS服务器</code>为主机<code>默认网关：192.168.2.1</code>（查看方式：Win10命令行窗口输入<code>ipconfig</code>）<br><img src=\"https://cdn.jsdelivr.net/gh/gavinst/PicGoCDN/img/img6qCuabZ3ONKtt0K8.png\"></li>\n<li>在<code>虚拟网络编辑器</code>界面，打开<code>DHCP设置</code>，查看<code>起始&amp;结束IP地址</code>，之后设置虚拟机<code>IPADDR</code>时，将在此之间<br><img src=\"https://cdn.jsdelivr.net/gh/gavinst/PicGoCDN/img/imgg9scAimnOs6CoClG.png\"></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"配置主机VMnet8网络适配器\"><a href=\"#配置主机VMnet8网络适配器\" class=\"headerlink\" title=\"配置主机VMnet8网络适配器\"></a>配置主机<code>VMnet8</code>网络适配器</h3><ul>\n<li>Win10命令行窗口输入<code>ncpa.cpl</code>，打开适配器选项</li>\n<li>右键<code>VMnet8 | 属性</code> &gt; 双击<code>TCP/IPv4</code>选项</li>\n<li>设置<code>IP地址</code>和虚拟机在同一网段<code>192.168.56.x</code></li>\n<li><code>首选DNS服务器</code>设置为主机<code>默认网关：192.168.2.1</code></li>\n</ul>\n<h3 id=\"配置虚拟机网卡信息\"><a href=\"#配置虚拟机网卡信息\" class=\"headerlink\" title=\"配置虚拟机网卡信息\"></a>配置虚拟机网卡信息</h3><ul>\n<li>查看虚拟机网络配置，虚拟机终端输入<code>ifconfig</code>，获取相应<code>device name</code>为<code>ens160</code></li>\n<li>切换<code>root</code>用户，编辑配置文件<ul>\n<li><code>vim /etc/sysconfig/network-scripts/ifcfg-ens160</code></li>\n</ul>\n</li>\n<li>填入虚拟机<code>NAT模式</code>的默认配置，修改后保存<ul>\n<li><code>IPADDR</code>设为之前查看的<code>DHCP</code>网段之间</li>\n<li><code>NETMASK</code>默认<code>255.255.255.0</code></li>\n<li><code>GATEWAY</code>子网网关<code>192.168.56.2</code><br><img src=\"https://cdn.jsdelivr.net/gh/gavinst/PicGoCDN/img/imgluBXopOV5sa5qujp.png\"></li>\n</ul>\n</li>\n<li>修改DNS客户机的配置文件<ul>\n<li><code>vim /etc/resolv.conf</code>，修改为<code>nameserver 192.168.56.2</code></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"重启虚拟机网络服务\"><a href=\"#重启虚拟机网络服务\" class=\"headerlink\" title=\"重启虚拟机网络服务\"></a>重启虚拟机网络服务</h3><details class=\"custom-details\">\n<summary>Click to see more</summary>\n<p><pre class=\"line-numbers language-none\"><code class=\"language-none\">nmcli c reload  &#x2F;&#x2F;vm下安装CentOS用此命令重启\n\nservice NetworkManager stop  &#x2F;&#x2F;临时关闭，避免与network重启冲突\nservice network restart\nservice NetworkManager restart</code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;其他命令\nservice NetworkManager status\nchkconfig NetworkManager off  &#x2F;&#x2F;禁止开机启动\nchkconfig NetworkManager on  &#x2F;&#x2F;开机启动</code></pre>\n</p>\n</details>\n<ul>\n<li>重启网络服务</li>\n<li>测试网络连接<ul>\n<li><code>ping baidu.com</code></li>\n</ul>\n</li>\n<li><code>Network</code>和<code>NetworkManager</code>区别<ul>\n<li><code>Network</code>：对网卡的配置，网络接口修改后，必须重启网络服务来刷新配置，或重启系统来激活</li>\n<li><code>NetworkManager</code>：检测、自动连接网络的程序</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"配置虚拟机网络代理\"><a href=\"#配置虚拟机网络代理\" class=\"headerlink\" title=\"配置虚拟机网络代理\"></a>配置虚拟机网络代理</h3><details class=\"custom-details\">\n<summary>Click to see more</summary>\n<p><img src=\"https://cdn.jsdelivr.net/gh/gavinst/PicGoCDN/img/imgz9srti7nO8pCoWnb.png\"></p>\n</details>\n<ul>\n<li><code>firefox</code>网页代理，首选项 &gt; 网络设置 &gt; 代理设置，设置代理IP和端口Port</li>\n<li><code>yum</code>代理，<code>echo &#39;proxy=IP:Port&#39; &gt;&gt; /etc/yum.conf</code></li>\n<li><code>wget</code>代理，<code>echo -e &#39;http_proxy = IP:Port\\nftp_proxy = IP:Port\\nuse_proxy = on&#39; &gt;&gt; /etc/wgetrc</code> </li>\n<li>系统环境代理<ul>\n<li>编辑文件<code>/etc/profile</code>，若只为当前账户代理，则编辑<code>~/.bashrc</code>，添加代理      <pre class=\"line-numbers language-none\"><code class=\"language-none\"># add proxy\nexport http_proxy&#x3D;&quot;IP:Port&quot;\nexport https_proxy&#x3D;&quot;IP:Port&quot;\nexport ftp_proxy&#x3D;$http_proxy</code></pre></li>\n<li>刷新环境变量，<code>source /etc/profile</code>或<code>source ~/.bashrc</code></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"装载共享文件夹\"><a href=\"#装载共享文件夹\" class=\"headerlink\" title=\"装载共享文件夹\"></a>装载共享文件夹</h3><ul>\n<li><p>添加共享文件夹，<code>VMware</code>菜单栏<code>虚拟机 | 设置</code> &gt; <code>选项 | 共享文件夹</code></p>\n<ul>\n<li>共享文件夹默认装载点<code>/mnt/hgfs</code>，终端执行<code>vmware-hgfsclient</code>命令可查看</li>\n<li>虚拟机须安装<code>VMware Tools</code>，若未安装，可先关闭虚拟机<ul>\n<li>将<code>cd/dvd</code>启动设为<code>VMware</code>安装目录下的<code>linux.iso</code>文件</li>\n<li>重启虚拟机，将虚拟光驱挂载到磁盘文件夹<code>mount /dev/cdrom /media</code></li>\n<li>解压并安装其中的<code>VMware Tools</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>在虚拟机中装载，查看官方文档：<a href=\"https://docs.vmware.com/cn/VMware-Workstation-Pro/16.0/com.vmware.ws.using.doc/GUID-AB5C80FE-9B8A-4899-8186-3DB8201B1758.html\">在 Linux 客户机中装载共享文件夹</a></p>\n<table>\n<thead>\n<tr>\n<th>4.0 之前的 Linux 内核</th>\n<th>4.0 及更高版本的 Linux 内核</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>mount -t vmhgfs .host:/ /home/user1/shares</code></td>\n<td><code>/usr/bin/vmhgfs-fuse .host:/ /home/user1/shares -o subtype=vmhgfs-fuse,allow_other</code></td>\n<td>将所有共享装载到 <code>/home/user1/shares</code></td>\n</tr>\n<tr>\n<td><code>mount -t vmhgfs .host:/foo /tmp/foo</code></td>\n<td><code>/usr/bin/vmhgfs-fuse .host:/foo /tmp/foo -o subtype=vmhgfs-fuse,allow_other</code></td>\n<td>将名为 <code>foo</code> 的共享装载到 <code>/tmp/foo</code></td>\n</tr>\n<tr>\n<td><code>mount -t vmhgfs .host:/foo/bar /var/lib/bar</code></td>\n<td><code>/usr/bin/vmhgfs-fuse .host:/foo/bar /var/lib/bar -o subtype=vmhgfs-fuse,allow_other</code></td>\n<td>将共享 <code>foo</code> 中的子目录 <code>bar</code> 装载到 <code>/var/lib/bar</code></td>\n</tr>\n</tbody></table>\n</li>\n<li><p>启动开机自动装载</p>\n<ul>\n<li>编辑<code>/etc/fstab</code>，添加所需装载命令</li>\n</ul>\n</li>\n</ul>\n","feature":true,"text":" 基本原理 通过VMnet8网卡实现主机与虚拟机之间的通信，在NAT模式中，主机网卡直接与虚拟NAT设备相连，然后虚拟NAT设备与虚拟DHCP服务器一起连接在虚拟交换机VMnet8上，这样就实现了虚拟机联网 启用VMware网址转换服务 win10WIN+R打开搜索框，输入ser...","link":"","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[{"name":"VMware","slug":"VMware","count":1,"path":"api/categories/VMware.json"}],"tags":[{"name":"vmware","slug":"vmware","count":1,"path":"api/tags/vmware.json"},{"name":"NAT","slug":"NAT","count":1,"path":"api/tags/NAT.json"},{"name":"centOS8","slug":"centOS8","count":1,"path":"api/tags/centOS8.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%90%AF%E7%94%A8VMware%E7%BD%91%E5%9D%80%E8%BD%AC%E6%8D%A2%E6%9C%8D%E5%8A%A1\"><span class=\"toc-text\">启用VMware网址转换服务</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%90%AF%E7%94%A8ICMPv4-in%E5%85%A5%E7%AB%99%E8%A7%84%E5%88%99\"><span class=\"toc-text\">启用ICMPv4-in入站规则</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E6%9C%BANAT%E6%A8%A1%E5%BC%8F\"><span class=\"toc-text\">配置虚拟机NAT模式</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE%E4%B8%BB%E6%9C%BAVMnet8%E7%BD%91%E7%BB%9C%E9%80%82%E9%85%8D%E5%99%A8\"><span class=\"toc-text\">配置主机VMnet8网络适配器</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BD%91%E5%8D%A1%E4%BF%A1%E6%81%AF\"><span class=\"toc-text\">配置虚拟机网卡信息</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%87%8D%E5%90%AF%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1\"><span class=\"toc-text\">重启虚拟机网络服务</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BB%A3%E7%90%86\"><span class=\"toc-text\">配置虚拟机网络代理</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%A3%85%E8%BD%BD%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9\"><span class=\"toc-text\">装载共享文件夹</span></a></li></ol>","author":{"name":"GUOWEI","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/gavinst/PicGoCDN/img/imgqBcR3R9huDgTp7QY.png","link":"/","description":"◽浩瀚苍穹 须臾人生◽</br>◽蜉蝣天地 沧海一粟◽</br>◽吾生有涯 而知无涯◽","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"myPortfolio","uid":"7971df0d06f7107c25ac7f01c3833ca2","slug":"myPortfolio","date":"2022-04-09T16:00:00.000Z","updated":"2022-04-17T18:11:54.086Z","comments":true,"path":"api/articles/myPortfolio.json","keywords":"webDesign","cover":null,"text":" Personal portfolio,hope you like it. ![1](https://cdn.jsdelivr.net/gh/gavinst/PicGoCDN/img/myportfolio (1).png)![2](https://cdn.jsdelivr.ne...","link":"","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[{"name":"personal","slug":"personal","count":1,"path":"api/categories/personal.json"}],"tags":[{"name":"PS","slug":"PS","count":1,"path":"api/tags/PS.json"}],"author":{"name":"GUOWEI","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/gavinst/PicGoCDN/img/imgqBcR3R9huDgTp7QY.png","link":"/","description":"◽浩瀚苍穹 须臾人生◽</br>◽蜉蝣天地 沧海一粟◽</br>◽吾生有涯 而知无涯◽","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"CSS 浮动与定位","uid":"4013f73311e4ca4fab812149e312063d","slug":"CSS浮动与定位","date":"2021-07-20T16:00:00.000Z","updated":"2022-01-22T01:45:14.894Z","comments":true,"path":"api/articles/CSS浮动与定位.json","keywords":"webDesign","cover":[],"text":"float 的影响 float 属性指定一个元素应沿其容器的左侧或右侧放置，允许文本和内联元素环绕它 浮动的元素可以向左或向右移动，直到它的外边缘碰到块框或另一个浮动元素的边框为止 由于浮动元素不在文档的普通流中，所以文档的普通流中的块框表现得像浮动元素不存在一样 float 属...","link":"","photos":[],"count_time":{"symbolsCount":"3.4k","symbolsTime":"3 mins."},"categories":[{"name":"Front-End","slug":"Front-End","count":11,"path":"api/categories/Front-End.json"},{"name":"CSS","slug":"Front-End/CSS","count":8,"path":"api/categories/Front-End/CSS.json"}],"tags":[{"name":"css","slug":"css","count":6,"path":"api/tags/css.json"},{"name":"float","slug":"float","count":1,"path":"api/tags/float.json"},{"name":"定位","slug":"定位","count":1,"path":"api/tags/定位.json"}],"author":{"name":"GUOWEI","slug":"blog-author","avatar":"https://cdn.jsdelivr.net/gh/gavinst/PicGoCDN/img/imgqBcR3R9huDgTp7QY.png","link":"/","description":"◽浩瀚苍穹 须臾人生◽</br>◽蜉蝣天地 沧海一粟◽</br>◽吾生有涯 而知无涯◽","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}